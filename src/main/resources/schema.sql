DROP TABLE IF EXISTS BOOKINGS CASCADE;
DROP TABLE IF EXISTS COMMENTS CASCADE;
DROP TABLE IF EXISTS ITEMS CASCADE;
DROP TABLE IF EXISTS USERS CASCADE;


CREATE TABLE IF NOT EXISTS USERS
(
    USER_ID BIGINT GENERATED BY DEFAULT AS IDENTITY NOT NULL,
    NAME    VARCHAR                           NOT NULL,
    EMAIL   VARCHAR                           NOT NULL UNIQUE,
    CONSTRAINT USERS_PK PRIMARY KEY (USER_ID)
);

CREATE TABLE IF NOT EXISTS ITEMS
(
    ITEM_ID     BIGINT GENERATED BY DEFAULT AS IDENTITY,
    NAME        VARCHAR NOT NULL UNIQUE,
    DESCRIPTION VARCHAR NOT NULL,
    AVAILABLE   BOOLEAN,
    USER_ID     BIGINT,
    CONSTRAINT ITEMS_PK PRIMARY KEY (ITEM_ID),
    CONSTRAINT ITEMS_USERS_FK FOREIGN KEY (USER_ID) REFERENCES USERS (USER_ID) ON DELETE CASCADE
);
CREATE TABLE IF NOT EXISTS BOOKINGS
(
    ID         BIGINT GENERATED BY DEFAULT AS IDENTITY,
    ITEM_ID    BIGINT REFERENCES ITEMS (ITEM_ID) ON DELETE CASCADE,
    BOOKER_ID  BIGINT REFERENCES USERS (USER_ID) ON DELETE CASCADE,
    START_DATE TIMESTAMP,
    END_DATE   TIMESTAMP,
    STATUS     VARCHAR,
    CONSTRAINT BOOKING_PK PRIMARY KEY (ID)

);
CREATE TABLE IF NOT EXISTS COMMENTS
(
    ID        BIGINT GENERATED BY DEFAULT AS IDENTITY,
    TEXT      VARCHAR,
    ITEM_ID   BIGINT REFERENCES ITEMS (ITEM_ID),
    AUTHOR_ID BIGINT REFERENCES USERS (USER_ID),
    CREATED   TIMESTAMP,
    CONSTRAINT COMMENT_PK PRIMARY KEY (ID)

);


